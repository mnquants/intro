credit_data <- read.csv("credit_train.csv")
credit_data
str(credit_data)
credit_data <- credit_data[ ,!colnames(credit_data) %in% c("Loan.ID", "Customer.ID")]
str(credit_data)
checkNA <- function(data){
apply(data, 2, function(x) mean(is.na(x)))
}
checkNA(credit_data)
credit_data <- credit_data[ ,!colnames(credit_data) %in% "Months.since.last.delinquent"]
credit_data$Annual.Income[which(is.na(credit_data$Annual.Income))] <- mean(credit_data$Annual.Income, na.rm = T)
credit_data_replace <- na.omit(credit_data)
checkNA(credit_data_replace)
set.seed(123)
ind <- sample(3, nrow(credit_data_replace), replace = TRUE, prob = c(.6, .2, .2))
ind
training <- credit_data_replace[ind == 1,]
validation <- credit_data_replace[ind == 2,]
testing <- credit_data_replace[ind == 3,]
training
modl1 <- glm(Loan.Status~., data = training, family = "binomial")
modl1
summary(modl1)
pred <- predict(modl1, validation[ ,-1], type = "response")
pred
modl1_pred_val <- rep("Charged Off",length(validation$Loan.Status))
modl1_pred_val[pred > .5] <- "Fully Paid"
table(modl1_pred_val, validation$Loan.Status)
modl2 <- step(modl1)
